## ä»‹ç»

ğŸ‰å›½äº§è‡ªç ”å·¥ä½œæµï¼Œå…¶ç‰¹ç‚¹ç®€æ´(åªæœ‰6å¼ è¡¨)ä½†åˆä¸ç®€é™‹ï¼Œäº”è„ä¿±å…¨ï¼Œç»„ä»¶ç‹¬ç«‹ï¼Œå¯æ‰©å±•ï¼Œå¯æ»¡è¶³ä¸­å°é¡¹ç›®çš„ç»„ä»¶ã€‚

1. æ”¯æŒç®€å•çš„æµç¨‹æµè½¬ï¼Œæ¯”å¦‚è·³è½¬ã€å›é€€ã€å®¡æ‰¹
2. ä¸šåŠ¡é¡¹ç›®å¯ä¸ä¾èµ–æµç¨‹è®¾è®¡å™¨ï¼Œç»„ä»¶ä¼šç”Ÿæˆæµç¨‹å›¾ç‰‡
3. æ”¯æŒè§’è‰²ã€éƒ¨é—¨å’Œç”¨æˆ·ç­‰æƒé™é…ç½®
4. æ”¯æŒå¢åŠ ç›‘å¬å™¨ï¼Œå‚æ•°ä¼ é€’ï¼ŒåŠ¨æ€æƒé™
5. æ”¯æŒå¤šç§Ÿæˆ·
6. æ”¯æŒäº’æ–¥ç½‘å…³ï¼Œå¹¶è¡Œç½‘å…³ï¼ˆæˆ–ç­¾ï¼‰
7. å¯è·³è½¬ä»»æ„èŠ‚ç‚¹
8. æ”¯æŒæ¡ä»¶è¡¨è¾¾å¼ï¼Œå¯æ‰©å±•
9. æ”¯æŒä¸åŒormæ¡†æ¶å’Œæ•°æ®åº“æ‰©å±•
10. åŒæ—¶æ”¯æŒspringå’Œsolon
11. å…¼å®¹java8å’Œjava17,ç†è®º11ä¹Ÿå¯ä»¥
12. å®˜æ–¹æä¾›ç®€å•æµç¨‹å°è£…demoé¡¹ç›®ï¼Œå¾ˆå®ç”¨

>  **å¸Œæœ›ä¸€é”®ä¸‰è¿ï¼Œä½ çš„â­ï¸ Star â­ï¸æ˜¯æˆ‘æŒç»­å¼€å‘çš„åŠ¨åŠ›ï¼Œé¡¹ç›®ä¹Ÿæ´»çš„æ›´é•¿**  
>   **å¯äºŒå¼€ã€å•†ç”¨ï¼Œä½†è¯·æ³¨æ˜å‡ºå¤„ï¼Œä¿ç•™ä»£ç æ³¨é‡Šä¸­çš„ä½œè€…åï¼Œ[ä½†æ˜¯ä½¿ç”¨å‰è¯·å…ˆç™»è®°](https://gitee.com/warm_4/warm-flow/issues/I7Y57D)**  
>
>   **[giteeåœ°å€](https://gitee.com/warm_4/warm-flow.git  )** |**[githubåœ°å€](https://github.com/minliuhua/warm-flow.git)**


## ä½¿ç”¨æ–‡æ¡£ä¸è”ç³»æ–¹å¼
http://warm_4.gitee.io/warm-flow-doc


**demoé¡¹ç›®**ï¼š  

springbootï¼š[RuoYi-Vue-Warm-Flow](https://gitee.com/min290/hh-vue) ï½œ[æ¼”ç¤ºåœ°å€](http://www.hhzai.top:81)  
solonï¼š[warm-sun](https://gitee.com/min290/warm-sun.git) ï½œ[æ¼”ç¤ºåœ°å€](http://www.warm-sun.vip)



## å¿«é€Ÿå¼€å§‹

åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å‡å®šæ‚¨å·²ç»ï¼š

* ç†Ÿæ‚‰ Java ç¯å¢ƒé…ç½®åŠå…¶å¼€å‘
* ç†Ÿæ‚‰ å…³ç³»å‹ æ•°æ®åº“ï¼Œæ¯”å¦‚ MySQL
* ç†Ÿæ‚‰ Spring Bootæˆ–è€…Solon åŠç›¸å…³æ¡†æ¶
* ç†Ÿæ‚‰ Java æ„å»ºå·¥å…·ï¼Œæ¯”å¦‚ Maven

### å¯¼å…¥sqlï¼ŒæŒ‰éœ€æ±‚æ‰§è¡Œå¢é‡è„šæœ¬
>   **å¦‚æœç¬¬ä¸€æ¬¡å¯¼å…¥ï¼Œè¯·å…ˆåˆ›å»ºæ•°æ®åº“ï¼Œå¹¶å¯¼å…¥ï¼šhttps://gitee.com/warm_4/warm-flow/blob/master/sql/warm-flow.sql**  
>   **å¦‚æœéœ€è¦å¢é‡æ›´æ–°ï¼Œè¯·æŒ‰éœ€å¯¼å…¥ï¼šhttps://gitee.com/warm_4/warm-flow/blob/master/sql/warm-flow_xxx.sql**


### mavenä¾èµ–

**springbooté¡¹ç›®**

```maven
<dependency>
      <groupId>io.github.minliuhua</groupId>
      <artifactId>warm-flow-mybatis-sb-starter</artifactId>
      <version>æœ€æ–°ç‰ˆæœ¬</version>
</dependency>
```

**soloné¡¹ç›®**

```maven
<dependency>
      <groupId>io.github.minliuhua</groupId>
      <artifactId>warm-flow-mybatis-solon-plugin</artifactId>
      <version>æœ€æ–°ç‰ˆæœ¬</version>
</dependency>
```

â€

### æ”¯æŒæ•°æ®åº“ç±»å‹

* [x] mysql
* [ ] oracle
* [ ] sqlserver
* [ ] ......


### æ”¯æŒormæ¡†æ¶ç±»å‹

* [x] mybatisåŠå…¶å¢å¼ºç»„ä»¶
* [ ] jpa
* [ ] easy-query
* [ ] wood
* [ ] sqltoy
* [ ] beetlsql
* [ ] ......




> **æœ‰æƒ³æ‰©å±•å…¶ä»–ormæ¡†æ¶å’Œæ•°æ®åº“çš„å¯åŠ qqç¾¤è”ç³»ç¾¤ä¸»**

### ä»£ç ç¤ºä¾‹

https://gitee.com/min290/hh-vue/blob/master/ruoyi-admin/src/test/java/com/ruoyi/system/service/impl/FlowTest.java



#### éƒ¨ç½²æµç¨‹

```java
public void deployFlow() throws Exception {
        String path = "/Users/minliuhua/Desktop/mdata/file/IdeaProjects/min/hh-vue/hh-admin/src/main/resources/leaveFlow-serial.xml";
        System.out.println("å·²éƒ¨ç½²æµç¨‹çš„idï¼š" + defService.importXml(new FileInputStream(path)).getId());
    }
```

#### å‘å¸ƒæµç¨‹

```java
public void publish() throws Exception {
        defService.publish(1212437969554771968L);
    }
```

#### å¼€å¯æµç¨‹

```java
public void startFlow() {
        System.out.println("å·²å¼€å¯çš„æµç¨‹å®ä¾‹idï¼š" + insService.start("1", getUser()).getId());
    }
```

#### æµç¨‹æµè½¬

```java
public void skipFlow() throws Exception {
        // é€šè¿‡å®ä¾‹idæµè½¬
        Instance instance = insService.skipByInsId(1219286332141080576L, getUser().skipType(SkipType.PASS.getKey())
                .permissionFlag(Arrays.asList("role:1", "role:2")));
        System.out.println("æµè½¬åæµç¨‹å®ä¾‹ï¼š" + instance.toString());

//        // é€šè¿‡ä»»åŠ¡idæµè½¬
//        Instance instance = insService.skip(1219286332145274880L, getUser().skipType(SkipType.PASS.getKey())
//                .permissionFlag(Arrays.asList("role:1", "role:2")));
//        System.out.println("æµè½¬åæµç¨‹å®ä¾‹ï¼š" + instance.toString());
    }

 public void skipAnyNode() throws Exception {
        // è·³è½¬åˆ°æŒ‡å®šèŠ‚ç‚¹
        Instance instance = insService.skip(1219286332145274880L, getUser().skipType(SkipType.PASS.getKey())
                .permissionFlag(Arrays.asList("role:1", "role:2")).nodeCode("4"));
        System.out.println("æµè½¬åæµç¨‹å®ä¾‹ï¼š" + instance.toString());
    }
```


#### å‚æ•°ä¼ é€’

```java
// æµç¨‹å˜é‡
Map<String, Object> variable = new HashMap<>();
variable.put("testLeave", testLeave);
flowParams.variable(variable);
Instance instance = insService.skip(taskId, flowParams);
```

#### ç›‘å¬å™¨
å®ç°Listeneræ¥å£ï¼Œç„¶ååœ¨è®¾è®¡å™¨ä¸­é…ç½®å¥½ç›‘å¬å™¨
```java
public class FinishListener implements Listener {

    @Resource
    private TestLeaveMapper testLeaveMapper;

    private static final Logger log = LoggerFactory.getLogger(StartListener.class);

    @Override
    public void notify(ListenerVariable variable) {
        log.info("å®Œæˆç›‘å¬å™¨:{}", variable);
        Instance instance = variable.getInstance();
        Map<String, Object> testLeaveMap = variable.getVariable();
        TestLeave testLeave = (TestLeave) testLeaveMap.get("testLeave");
        /** å¦‚æœ{@link com.ruoyi.system.service.impl.TestLeaveServiceImpl}ä¸­æ›´æ–°äº†ï¼Œè¿™é‡Œå°±ä¸ç”¨æ›´æ–°äº†*/
//        testLeave.setNodeCode(instance.getNodeCode());
//        testLeave.setNodeName(instance.getNodeName());
//        testLeave.setFlowStatus(instance.getFlowStatus());
//        testLeave.setUpdateTime(DateUtils.getNowDate());
//        testLeaveMapper.updateTestLeave(testLeave);
        log.info("å®Œæˆç›‘å¬å™¨ç»“æŸ;{}", "ä»»åŠ¡å®Œæˆ");
    }
}
```


## ä½ å¯ä»¥è¯·ä½œè€…å–æ¯å’–å•¡è¡¨ç¤ºé¼“åŠ±

![è¾“å…¥å›¾ç‰‡è¯´æ˜](https://foruda.gitee.com/images/1697770422557390406/7efa04d6_2218307.png "å±å¹•æˆªå›¾")


### ç‰¹åˆ«æ„Ÿè°¢JetBrainså¯¹å¼€æºé¡¹ç›®æ”¯æŒ

<a href="https://jb.gg/OpenSourceSupport">
  <img src="https://user-images.githubusercontent.com/8643542/160519107-199319dc-e1cf-4079-94b7-01b6b8d23aa6.png" align="left" height="100" width="100"  alt="JetBrains">
</a>

